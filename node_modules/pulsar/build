# compile
rm -rf dist
mkdir dist
coffee -o dist -c lib/Client.coffee lib/Channel.coffee

# build
cat node_modules/protosock/protosock.js > pulsar.js
cat dist/Channel.js >> pulsar.js
cat dist/Client.js >> pulsar.js

# minify
node_modules/.bin/uglifyjs -nc --unsafe -mt -o pulsar.min.js pulsar.js
echo "File size (minified): " && cat pulsar.min.js | wc -c
echo "File size (gzipped): " && cat pulsar.min.js | gzip -9f  | wc -c
cp ./pulsar.js ./example/pulsar.js

# clean
rm -rf dist